<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Texture Ripper</title>
    <link rel="shortcut icon" type="image/png" href="icon.png"/>
  </head>
  <body>
    <h2>Texture Ripper</h2>
    <p>Get perspective accurate textures for 3D modeling and graphics from any image in an easy to use website.</p>
    
    <input type='file' id='button' multiple accept="image/png">
    <br>
    <img id="preview">
    <br>
    <p id="resolution"></p>

    <script type="module">
      import init, {run} from './wasm/wasm.js';

      (async () => {
        await init();

        var button = document.getElementById('button');

        button.addEventListener('input', (event) => {
          let file = event.target.files[0];

          const reader = new FileReader();

          reader.readAsArrayBuffer(file);

          reader.onloadend = function() {
            const bytes = new Uint8Array(reader.result);

            const invertedImage = run(bytes);
            const previewElem = document.getElementById('preview');

            const file = new File([invertedImage.buffer], "output.png", {type: 'image/png'});

            previewElem.src = URL.createObjectURL(file);
          };
        });
      })(); 
    </script>
  </body>
</html>
